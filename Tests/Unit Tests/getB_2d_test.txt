******************************************************
Test #1:
 
Code:

real(dp) :: posn(2,4)
real(dp) :: B(3,8)
real(dp) :: J(2,2)
integer :: elnum
posn(:,1) = [0.0_dp, 0.0_dp]
posn(:,2) = [1.0_dp, 0.0_dp]
posn(:,3) = [1.0_dp, 1.0_dp]
posn(:,4) = [0.0_dp, 1.0_dp]
call initMaterialData('example_materials_test')
call initFELibrary()
elnum = getElNum('CPE4')
call getB_2d(posn,0.0_dp,0.0_dp,elnum,B,J)
call prettyPrintMat(B,'B')

Output:

 B
 -0.50000000000000000        0.0000000000000000       0.50000000000000000        0.0000000000000000       0.50000000000000000        0.0000000000000000      -0.50000000000000000        0.0000000000000000     
   0.0000000000000000      -0.50000000000000000        0.0000000000000000      -0.50000000000000000        0.0000000000000000       0.50000000000000000        0.0000000000000000       0.50000000000000000     
 -0.50000000000000000      -0.50000000000000000      -0.50000000000000000       0.50000000000000000       0.50000000000000000       0.50000000000000000       0.50000000000000000      -0.50000000000000000     

******************************************************
Test #2:
 
Code:

real(dp) :: posn(2,3)
real(dp) :: B(3,6)
real(dp) :: J(2,2)
integer :: elnum
posn(:,1) = [0.0_dp, 0.0_dp]
posn(:,2) = [1.0_dp, 0.0_dp]
posn(:,3) = [0.0_dp, 1.0_dp]
call initMaterialData('example_materials_test')
call initFELibrary()
elnum = getElNum('CPE3')
call getB_2d(posn,0.33_dp,0.33_dp,elnum,B,J)
call prettyPrintMat(B,'B')

Output: 
 B
  -1.0000000000000000        0.0000000000000000        1.0000000000000000        0.0000000000000000        0.0000000000000000        0.0000000000000000     
   0.0000000000000000       -1.0000000000000000        0.0000000000000000        0.0000000000000000        0.0000000000000000        1.0000000000000000     
  -1.0000000000000000       -1.0000000000000000        0.0000000000000000        1.0000000000000000        1.0000000000000000        0.0000000000000000
******************************************************  
     
