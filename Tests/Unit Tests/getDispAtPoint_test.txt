******************************************************
Test #1: x-displacement
 
Code:

      integer :: i, j
      real(dp) :: res(11,11)
      real(dp) :: x, y
      real(dp) :: posn(2), dislpos(2)
      real(dp) :: theta, cost, sint
      real(dp) :: disp(2)
      real(dp) :: mu, nu, burgers
      call initMaterialData('example_materials_test2')
      mu = 20.0_dp
      nu = 0.3_dp
      burgers = 2.0_dp
      materials(1)%mu = mu
      materials(1)%nu = nu
      materials(1)%burgers = burgers
      materials(1)%dispprefac = 0.25_dp*burgers/(piconst*(1.0_dp-nu))
      materials(1)%stressprefac =0.5_dp*burgers*mu/(piconst*(1.0_dp-nu))
      materials(1)%rcoresq = 4.0_dp
      theta = piconst/6.0_dp
      sint = sin(theta)
      cost = cos(theta)
      dislpos = [0.0_dp, 0.0_dp]
      do i = 1, 11
        x = -10.0_dp + (i - 1.0_dp)*2.0_dp
        do j = 1, 11
            y = 10.0_dp - (j - 1.0_dp)*2.0_dp
            posn(1) = x
            posn(2) = y
            disp = getDispAtPoint(posn,dislpos,cost,sint,1,0,1,1.0_dp)
            res(j,i) = disp(1)
        end do
      end do
      call prettyPrintMat(res,'Displacement, ux')
  
Output: (Checked with Python module dislfields --- see iPython Notebook 'Dislocation Fields.ipynb')

 Displacement, ux
  0.43883424579751173       0.41869648221376610       0.40086502336455748       0.38654953145489518       0.37492914119835069       0.36186084869863810       0.34183125635451678       0.31256066529945220       0.27665423451276266       0.23879296426750712       0.20272472084164664     
  0.45475039793214977       0.42868727459444417       0.40381214473097915       0.38310083394854799       0.36760683049613369       0.35171387749557054       0.32520333331077678       0.28500105136226200       0.23805843907617941       0.19257774963857907       0.15282983294539318     
  0.48243137924537688       0.45021310249111962       0.41560555348883793       0.38322681683014859       0.35928370294858397       0.33863215638996436       0.30003523135354654       0.24080076962161115       0.17949602853297286       0.12799550407928093        8.8092958906299368E-002
  0.52745655046389517       0.49228195038029987       0.44833280733854325       0.39716790314406536       0.35158146249816918       0.32019450604519173       0.25348167991188325       0.16105837818820026        8.8247008183603717E-002   3.9401412280314033E-002   7.0106017126294762E-003
  0.59417464200183367       0.56524797940192051       0.52396034531715596       0.46076257892992106       0.36564853169368655       0.28867513459481292       0.12953900673782148        7.8820408299352437E-003  -4.6532774548620176E-002  -7.3053290080592428E-002  -8.7288894680036963E-002
  0.68119144838236079       0.67104447717929327       0.65796275607368704       0.63952510572891441       0.60800573427853566       0.25811688831003854      -0.25801966950590310      -0.22650029805552432      -0.20806264771075167      -0.19498092660514552      -0.18483395540207792     
  0.77873650910440184       0.79297211370384635       0.81949262923581856       0.87390744461437397      -0.73648639704661722      -0.57735026918962573      -0.50037687209075221      -0.40526282485451764      -0.34206505846728275      -0.30077742438251809      -0.27185076178260503     
  0.87303600549706828       0.90542681606475273      -0.77777839560083506      -0.70496702559623847      -0.61254372387255551      -0.54583089773924698      -0.51444394128626958      -0.46885750064037340      -0.41769259644589557      -0.37374345340413884      -0.33856885332054359     
 -0.77793244487813940      -0.73802989970515775      -0.68652937525146585      -0.62522463416282759      -0.56599017243089211      -0.52739324739447435      -0.50674170083585479      -0.48279858695429018      -0.45041985029560083      -0.41581230129331914      -0.38359402453906194     
 -0.71319557083904561      -0.67344765414585961      -0.62796696470825941      -0.58102435242217676      -0.54082207047366193      -0.51431152628886823      -0.49841857328830502      -0.48292456983589077      -0.46221325905345950      -0.43733812918999460      -0.41127500585228893     
 -0.66330068294279210      -0.62723243951693164      -0.58937116927167610      -0.55346473848498645      -0.52419414742992199      -0.50416455508580060      -0.49109626258608802      -0.47947587232954358      -0.46516038041988123      -0.44732892157067261      -0.42719115798692708     

******************************************************
Test #2: y-displacement
 
Code:

  integer :: i, j
  real(dp) :: res(11,11)
  real(dp) :: x, y
  real(dp) :: posn(2), dislpos(2)
  real(dp) :: theta
  real(dp) :: disp(2)
  call initMaterialData('example_materials_test2')
  materials(1)%mu = 20.0_dp
  materials(1)%nu = 0.3_dp
  materials(1)%burgers = 2.0_dp
  theta = piconst/6.0_dp
  dislpos = [0.0_dp, 0.0_dp]
  do i = 1, 11
    x = -10.0_dp + (i - 1.0_dp)*2.0_dp
    do j = 1, 11
        y = 10.0_dp - (j - 1.0_dp)*2.0_dp
        posn(1) = x
        posn(2) = y
        disp = getDispAtPoint(posn,dislpos,theta,1,1)
        res(j,i) = disp(2)
    end do
  end do
  call prettyPrintRealMat(res,'Displacement, uy')

Output: (Checked with Python module dislfields --- see iPython Notebook 'Dislocation Fields.ipynb')

 Displacement, uy
  0.29290135463571076       0.30332979215500616       0.30874239978272261       0.30356473108837634       0.28096915449663457       0.23680846838698563       0.17441231084282702       0.10404433969856976        3.6413792917300854E-002  -2.2356288376005968E-002  -7.0780747572785879E-002
  0.29533043103649831       0.31047642430236211       0.32290711609954315       0.32548001754165579       0.30615185722670279       0.25438353805363695       0.17467526698651153        8.6950718124425133E-002   8.9395332802529367E-003  -5.3205677906134549E-002 -0.10080222444906835     
  0.29406121160180765       0.31294146185823057       0.33313462990771814       0.34802709872978699       0.33851508375135425       0.27704174365899298       0.16788944007668952        5.5922731803252808E-002  -3.0547472300778492E-002  -9.1360591562792803E-002 -0.13422565601835287     
  0.28986073033672460       0.30975449372940983       0.33512806578942117       0.36506957707705412       0.38007317031634780       0.30897669082832896       0.14154387089911716        1.3874748685574810E-003  -8.2642217515115426E-002 -0.13360757038695417      -0.16742177787139520     
  0.28637941759715246       0.30443462955255024       0.32857615985270400       0.36434764650410184       0.41966272985174613       0.36356984360302103        5.5980627643249493E-002  -7.9014417612262175E-002 -0.13721671912282724      -0.17108369993290234      -0.19451150967865272     
  0.28990529145063126       0.30748036111728261       0.33013856672263864       0.36207351389197462       0.41666666666666663       0.28029263957242545       -8.3333333333333329E-002 -0.13792648610802535      -0.16986143327736131      -0.19251963888271736      -0.21009470854936868     
  0.30548849032134728       0.32891630006709760       0.36278328087717271       0.42098558238773776      -0.44401937235675049      -0.13643015639697895       -8.0337270148253828E-002 -0.13565235349589810      -0.17142384014729592      -0.19556537044744970      -0.21362058240284748     
  0.33257822212860477       0.36639242961304574      -0.58264221751511536      -0.49861252513144250      -0.35845612910088281      -0.19102330917167096      -0.11992682968365219      -0.13493042292294583      -0.16487193421057886      -0.19024550627059011      -0.21013926966327534     
 -0.63422565601835279      -0.59136059156279275      -0.53054747230077848      -0.44407726819674714      -0.33211055992331040      -0.22295825634100697      -0.16148491624864575      -0.15197290127021298      -0.16686537009228183      -0.18705853814176945      -0.20593878839819235     
 -0.60080222444906828      -0.55320567790613451      -0.49106046671974707      -0.41304928187557483      -0.32532473301348841      -0.24561646194636300      -0.19384814277329712      -0.17451998245834421      -0.17709288390045677      -0.18952357569763786      -0.20466956896350161     
 -0.57078074757278585      -0.52235628837600601      -0.46358620708269915      -0.39595566030143015      -0.32558768915717295      -0.26319153161301428      -0.21903084550336538      -0.19643526891162366      -0.19125760021727731      -0.19667020784499378      -0.20709864536428924
******************************************************