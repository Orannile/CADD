******************************************************
Test #1:
 
Code:

integer :: neqnsnormal, neqnstot
integer :: nentriesnormal, nentriestot
integer :: mnum
integer :: j
real(dp) :: C(3,3)
integer :: eltypenum
call initNodeData('simplefe_nodes')
call initMaterialData('simplefe_materials')
call initFELibrary()
call initFEElementData('simplefe_feelements')
call countEqns(1,neqnsnormal,nentriesnormal,
&                            neqnstot,nentriestot)
call initAssembly()
mnum = fematerials%list(1)
C = materials(mnum)%elconst
eltypenum = getElTypeNum('CPE4')
call assembleKNormal(1,eltypenum,C)
do j = 1, nentriestot
  write(*,*) assembly(1)%rowindex(j), assembly(1)%colindex(j),
&               assembly(1)%Ksparse(j)
end do

Output: (Compare against input_quad4_assembly.txt --- generated using Allan Bower's code)
           1           1   14.145081595150417     
           1           2   5.3044055981796880     
           1           3  -8.8406759969707291     
           1           4   2.2204460492503131E-016
           1          13  -7.0725407975683323     
           1          14  -5.3044055981796872     
           1          11   1.7681351993886447     
           1          12   2.2204460492503131E-016
           2           2   14.145081595150417     
           2           3   2.2204460492503131E-016
           2           4   1.7681351993886447     
           2          13  -5.3044055981796872     
           2          14  -7.0725407975683323     
           2          11   0.0000000000000000     
           2          12  -8.8406759969707291     
           3           3   14.145081595150419     
           3           4  -5.3044055981796872     
           3          13   1.7681351993886447     
           3          14  -1.1102230246251565E-016
           3          11  -7.0725407975683323     
           3          12   5.3044055981796872     
           4           4   14.145081595150419     
           4          13  -5.5511151231257827E-017
           4          14  -8.8406759969707309     
           4          11   5.3044055981796872     
           4          12  -7.0725407975683323     
          13          13   14.145081595150419     
          13          14   5.3044055981796872     
          13          11  -8.8406759969707309     
          13          12   1.6653345369377348E-016
          14          14   14.145081595150417     
          14          11   1.6653345369377348E-016
          14          12   1.7681351993886447     
          11          11   14.145081595150419     
          11          12  -5.3044055981796872     
          12          12   14.145081595150417     
           3           3   14.145081595150417     
           3           4   5.3044055981796880     
           3           5  -8.8406759969707291     
           3           6   2.2204460492503131E-016
           3          15  -7.0725407975683323     
           3          16  -5.3044055981796872     
           3          13   1.7681351993886447     
           3          14   2.2204460492503131E-016
           4           4   14.145081595150417     
           4           5   2.2204460492503131E-016
           4           6   1.7681351993886447     
           4          15  -5.3044055981796872     
           4          16  -7.0725407975683323     
           4          13   0.0000000000000000     
           4          14  -8.8406759969707291     
           5           5   14.145081595150419     
           5           6  -5.3044055981796872     
           5          15   1.7681351993886447     
           5          16  -1.1102230246251565E-016
           5          13  -7.0725407975683323     
           5          14   5.3044055981796872     
           6           6   14.145081595150419     
           6          15  -5.5511151231257827E-017
           6          16  -8.8406759969707309     
           6          13   5.3044055981796872     
           6          14  -7.0725407975683323     
          15          15   14.145081595150419     
          15          16   5.3044055981796872     
          15          13  -8.8406759969707309     
          15          14   1.6653345369377348E-016
          16          16   14.145081595150417     
          16          13   1.6653345369377348E-016
          16          14   1.7681351993886447     
          13          13   14.145081595150419     
          13          14  -5.3044055981796872     
          14          14   14.145081595150417     
           5           5   14.145081595150417     
           5           6   5.3044055981796880     
           5           7  -8.8406759969707291     
           5           8   2.2204460492503131E-016
           5          17  -7.0725407975683323     
           5          18  -5.3044055981796872     
           5          15   1.7681351993886447     
           5          16   2.2204460492503131E-016
           6           6   14.145081595150417     
           6           7   2.2204460492503131E-016
           6           8   1.7681351993886447     
           6          17  -5.3044055981796872     
           6          18  -7.0725407975683323     
           6          15   0.0000000000000000     
           6          16  -8.8406759969707291     
           7           7   14.145081595150419     
           7           8  -5.3044055981796872     
           7          17   1.7681351993886447     
           7          18  -1.1102230246251565E-016
           7          15  -7.0725407975683323     
           7          16   5.3044055981796872     
           8           8   14.145081595150419     
           8          17  -5.5511151231257827E-017
           8          18  -8.8406759969707309     
           8          15   5.3044055981796872     
           8          16  -7.0725407975683323     
          17          17   14.145081595150419     
          17          18   5.3044055981796872     
          17          15  -8.8406759969707309     
          17          16   1.6653345369377348E-016
          18          18   14.145081595150417     
          18          15   1.6653345369377348E-016
          18          16   1.7681351993886447     
          15          15   14.145081595150419     
          15          16  -5.3044055981796872     
          16          16   14.145081595150417     
           7           7   14.145081595150417     
           7           8   5.3044055981796880     
           7           9  -8.8406759969707291     
           7          10   2.2204460492503131E-016
           7          19  -7.0725407975683323     
           7          20  -5.3044055981796872     
           7          17   1.7681351993886447     
           7          18   2.2204460492503131E-016
           8           8   14.145081595150417     
           8           9   2.2204460492503131E-016
           8          10   1.7681351993886447     
           8          19  -5.3044055981796872     
           8          20  -7.0725407975683323     
           8          17   0.0000000000000000     
           8          18  -8.8406759969707291     
           9           9   14.145081595150419     
           9          10  -5.3044055981796872     
           9          19   1.7681351993886447     
           9          20  -1.1102230246251565E-016
           9          17  -7.0725407975683323     
           9          18   5.3044055981796872     
          10          10   14.145081595150419     
          10          19  -5.5511151231257827E-017
          10          20  -8.8406759969707309     
          10          17   5.3044055981796872     
          10          18  -7.0725407975683323     
          19          19   14.145081595150419     
          19          20   5.3044055981796872     
          19          17  -8.8406759969707309     
          19          18   1.6653345369377348E-016
          20          20   14.145081595150417     
          20          17   1.6653345369377348E-016
          20          18   1.7681351993886447     
          17          17   14.145081595150419     
          17          18  -5.3044055981796872     
          18          18   14.145081595150417     
          11          11   14.145081595150417     
          11          12   5.3044055981796880     
          11          13  -8.8406759969707291     
          11          14   2.2204460492503131E-016
          11          23  -7.0725407975683323     
          11          24  -5.3044055981796872     
          11          21   1.7681351993886447     
          11          22   2.2204460492503131E-016
          12          12   14.145081595150417     
          12          13   2.2204460492503131E-016
          12          14   1.7681351993886447     
          12          23  -5.3044055981796872     
          12          24  -7.0725407975683323     
          12          21   0.0000000000000000     
          12          22  -8.8406759969707291     
          13          13   14.145081595150419     
          13          14  -5.3044055981796872     
          13          23   1.7681351993886447     
          13          24  -1.1102230246251565E-016
          13          21  -7.0725407975683323     
          13          22   5.3044055981796872     
          14          14   14.145081595150419     
          14          23  -5.5511151231257827E-017
          14          24  -8.8406759969707309     
          14          21   5.3044055981796872     
          14          22  -7.0725407975683323     
          23          23   14.145081595150419     
          23          24   5.3044055981796872     
          23          21  -8.8406759969707309     
          23          22   1.6653345369377348E-016
          24          24   14.145081595150417     
          24          21   1.6653345369377348E-016
          24          22   1.7681351993886447     
          21          21   14.145081595150419     
          21          22  -5.3044055981796872     
          22          22   14.145081595150417     
          13          13   14.145081595150417     
          13          14   5.3044055981796880     
          13          15  -8.8406759969707291     
          13          16   2.2204460492503131E-016
          13          25  -7.0725407975683323     
          13          26  -5.3044055981796872     
          13          23   1.7681351993886447     
          13          24   2.2204460492503131E-016
          14          14   14.145081595150417     
          14          15   2.2204460492503131E-016
          14          16   1.7681351993886447     
          14          25  -5.3044055981796872     
          14          26  -7.0725407975683323     
          14          23   0.0000000000000000     
          14          24  -8.8406759969707291     
          15          15   14.145081595150419     
          15          16  -5.3044055981796872     
          15          25   1.7681351993886447     
          15          26  -1.1102230246251565E-016
          15          23  -7.0725407975683323     
          15          24   5.3044055981796872     
          16          16   14.145081595150419     
          16          25  -5.5511151231257827E-017
          16          26  -8.8406759969707309     
          16          23   5.3044055981796872     
          16          24  -7.0725407975683323     
          25          25   14.145081595150419     
          25          26   5.3044055981796872     
          25          23  -8.8406759969707309     
          25          24   1.6653345369377348E-016
          26          26   14.145081595150417     
          26          23   1.6653345369377348E-016
          26          24   1.7681351993886447     
          23          23   14.145081595150419     
          23          24  -5.3044055981796872     
          24          24   14.145081595150417     
          15          15   14.145081595150417     
          15          16   5.3044055981796880     
          15          17  -8.8406759969707291     
          15          18   2.2204460492503131E-016
          15          27  -7.0725407975683323     
          15          28  -5.3044055981796872     
          15          25   1.7681351993886447     
          15          26   2.2204460492503131E-016
          16          16   14.145081595150417     
          16          17   2.2204460492503131E-016
          16          18   1.7681351993886447     
          16          27  -5.3044055981796872     
          16          28  -7.0725407975683323     
          16          25   0.0000000000000000     
          16          26  -8.8406759969707291     
          17          17   14.145081595150419     
          17          18  -5.3044055981796872     
          17          27   1.7681351993886447     
          17          28  -1.1102230246251565E-016
          17          25  -7.0725407975683323     
          17          26   5.3044055981796872     
          18          18   14.145081595150419     
          18          27  -5.5511151231257827E-017
          18          28  -8.8406759969707309     
          18          25   5.3044055981796872     
          18          26  -7.0725407975683323     
          27          27   14.145081595150419     
          27          28   5.3044055981796872     
          27          25  -8.8406759969707309     
          27          26   1.6653345369377348E-016
          28          28   14.145081595150417     
          28          25   1.6653345369377348E-016
          28          26   1.7681351993886447     
          25          25   14.145081595150419     
          25          26  -5.3044055981796872     
          26          26   14.145081595150417     
          17          17   14.145081595150417     
          17          18   5.3044055981796880     
          17          19  -8.8406759969707291     
          17          20   2.2204460492503131E-016
          17          29  -7.0725407975683323     
          17          30  -5.3044055981796872     
          17          27   1.7681351993886447     
          17          28   2.2204460492503131E-016
          18          18   14.145081595150417     
          18          19   2.2204460492503131E-016
          18          20   1.7681351993886447     
          18          29  -5.3044055981796872     
          18          30  -7.0725407975683323     
          18          27   0.0000000000000000     
          18          28  -8.8406759969707291     
          19          19   14.145081595150419     
          19          20  -5.3044055981796872     
          19          29   1.7681351993886447     
          19          30  -1.1102230246251565E-016
          19          27  -7.0725407975683323     
          19          28   5.3044055981796872     
          20          20   14.145081595150419     
          20          29  -5.5511151231257827E-017
          20          30  -8.8406759969707309     
          20          27   5.3044055981796872     
          20          28  -7.0725407975683323     
          29          29   14.145081595150419     
          29          30   5.3044055981796872     
          29          27  -8.8406759969707309     
          29          28   1.6653345369377348E-016
          30          30   14.145081595150417     
          30          27   1.6653345369377348E-016
          30          28   1.7681351993886447     
          27          27   14.145081595150419     
          27          28  -5.3044055981796872     
          28          28   14.145081595150417     
          14           0   0.0000000000000000     
           8           0   0.0000000000000000     
           4           0   0.0000000000000000     
           1           0   0.0000000000000000     
          10           0   0.0000000000000000     
          15           0   0.0000000000000000     
           8           0   0.0000000000000000     
           2           0   0.0000000000000000     
           0           0   0.0000000000000000 
******************************************************
