******************************************************
Test #1:
 
Code:

real(dp) :: posn(2,4)
real(dp) :: K(8,8)
integer :: elnum
posn(:,1) = [0.0_dp, 0.0_dp]
posn(:,2) = [1.0_dp, 0.0_dp]
posn(:,3) = [1.0_dp, 2.0_dp]
posn(:,4) = [0.0_dp, 2.0_dp]
call initMaterialData('example_materials_test')
call initFELibrary()
elnum = getElNum('CPE4')
K = getK_2d(posn,materials(1)%elconst,elnum)
call prettyPrintMat(K,'K')

Output: (Compared to Allan Bower's code ('FEM_2Dor3D_linelast_standard.m') --- see input_quad4_simple.txt

 K
   22.985757592119427        5.3044055981796880       -20.333554793029585        2.2204460492503131E-016  -11.492878796048540       -5.3044055981796872        8.8406759969586961        2.2204460492503131E-016
   5.3044055981796880        12.376946395756615        2.2204460492503131E-016  -4.4203379984870841       -5.3044055981796872       -6.1884731978722911        0.0000000000000000       -1.7681351993972403     
  -20.333554793029585       -2.2204460492503131E-016   22.985757592119427       -5.3044055981796872        8.8406759969586961       -1.1102230246251565E-016  -11.492878796048540        5.3044055981796872     
  -2.2204460492503131E-016  -4.4203379984870841       -5.3044055981796872        12.376946395756613       -5.5511151231257827E-017  -1.7681351993972401        5.3044055981796872       -6.1884731978722911     
  -11.492878796048540       -5.3044055981796880        8.8406759969586961        1.1102230246251565E-016   22.985757592119427        5.3044055981796872       -20.333554793029585        1.6653345369377348E-016
  -5.3044055981796880       -6.1884731978722911        5.5511151231257827E-017  -1.7681351993972401        5.3044055981796872        12.376946395756615        1.6653345369377348E-016  -4.4203379984870841     
   8.8406759969586961       -2.2204460492503131E-016  -11.492878796048540        5.3044055981796872       -20.333554793029585       -1.1102230246251565E-016   22.985757592119427       -5.3044055981796872     
   0.0000000000000000       -1.7681351993972403        5.3044055981796872       -6.1884731978722911       -1.6653345369377348E-016  -4.4203379984870841       -5.3044055981796872        12.376946395756615     

****************************************************** 
Test #2:

Code:

real(dp) :: posn(2,4)
real(dp) :: K(8,8)
integer :: elnum
posn(:,1) = [0.0_dp, 0.5_dp]
posn(:,2) = [1.2_dp, 0.0_dp]
posn(:,3) = [1.4_dp, 2.0_dp]
posn(:,4) = [-3.0_dp, 2.1_dp]
call initMaterialData('example_materials_test')
call initFELibrary()
elnum = getElNum('CPE4')
K = getK_2d(posn,materials(1)%elconst,elnum)
call prettyPrintRealMat(K,'K')

Output: (Compared to Allan Bower's code ('FEM_2Dor3D_linelast_standard.m') --- see input_quad4_simple2.txt

 K
   35.845882547740615        17.041611281059474       -15.899552992126747       -7.2131408113293736       -16.858472805641256       -9.7973058972613050       -3.0878567499726071       -3.1164572468795424E-002
   17.041611281059474        63.553499920741459       -7.2131408113293736       -15.097553052958947       -9.7973058972613050       -31.452279249085034       -3.1164572468795670E-002  -17.003667618697474     
  -15.899552992126750       -7.2131408113293736        15.584029833621349        1.6269964743899314        1.3898997424952666        1.6772430463861014       -1.0743765839898669        3.9089012905533402     
  -7.2131408113293736       -15.097553052958947        1.6269964743899314        22.560914080677662        1.6772430463861014       -9.4333117233408661        3.9089012905533402        1.9699506956221498     
  -16.858472805641256       -9.7973058972613050        1.3898997424952657        1.6772430463861012        17.762635174312660        10.142272820299315       -2.2940621111666650       -2.0222099694241100     
  -9.7973058972613050       -31.452279249085038        1.6772430463861010       -9.4333117233408661        10.142272820299315        32.980908804878204       -2.0222099694241100        7.9046821675476986     
  -3.0878567499726075       -3.1164572468795670E-002  -1.0743765839898674        3.9089012905533407       -2.2940621111666655       -2.0222099694241100        6.4562954451291406       -1.8555267486604352     
  -3.1164572468795670E-002  -17.003667618697477        3.9089012905533407        1.9699506956221493       -2.0222099694241096        7.9046821675476986       -1.8555267486604352        7.1290347555276279     
******************************************************
Test #3:

Code:

real(dp) :: posn(2,3)
real(dp) :: K(6,6)
integer :: elnum
posn(:,1) = [0.0_dp, 0.5_dp]
posn(:,2) = [1.2_dp, 0.0_dp]
posn(:,3) = [3.0_dp, 2.1_dp]
call initMaterialData('example_materials_test')
call initFELibrary()
elnum = getElNum('CPE3')
K = getK_2d(posn,materials(1)%elconst,elnum)
call prettyPrintRealMat(K,'K')

Output: (Compared to Allan Bower's code ('FEM_2Dor3D_linelast_standard.m') --- see input_quad4_simple3.txt

 K
   25.544900643865322       -11.725528164397199       -24.009414812813315        14.238141342482315       -1.5354858310520134       -2.5126131780851138     
  -11.725528164397200        21.915570497742387        14.238141342482315       -30.337477631694345       -2.5126131780851142        8.4219071339519562     
  -24.009414812813315        14.238141342482315        25.870609759543033       -14.889559573837717       -1.8611949467297146       0.65141823135539978     
   14.238141342482315       -30.337477631694345       -14.889559573837717        45.847435521108636       0.65141823135540011       -15.509957889414286     
  -1.5354858310520136       -2.5126131780851142       -1.8611949467297149       0.65141823135540011        3.3966807777817287        1.8611949467297146     
  -2.5126131780851138        8.4219071339519580       0.65141823135539978       -15.509957889414286        1.8611949467297146        7.0880507554623291     

******************************************************  